/* ============================================
   Org Mode HTML Export CSS - ç»æµå­¦ç¬”è®°ä¸“ç”¨
   é…è‰²æ–¹æ¡ˆï¼šè«å…°è¿ªè‰²ç³» (Morandi Colors)
   ç‰¹æ€§ï¼šè‡ªåŠ¨é€‚é…å¤œé—´æ¨¡å¼ (Dark Mode)
   é€‚é…ï¼šä¸­æ–‡æ’ç‰ˆä¼˜åŒ–
   ============================================ */

/* -------------------------------------------
   é¢œè‰²å˜é‡å®šä¹‰ - æ—¥é—´æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
   ------------------------------------------- */
:root {
  /* åŸºç¡€èƒŒæ™¯ä¸æ–‡å­— */
  --bg-primary: #f7f5f0;
  --bg-secondary: #f0ede8;
  --bg-tertiary: #e8e4de;
  --text-primary: #4a4a4a;
  --text-secondary: #6b6864;
  --text-muted: #8b8680;

  /* è«å…°è¿ªå¼ºè°ƒè‰² */
  --morandi-blue: #7a8fa3;
  --morandi-rose: #b8a8a0;
  --morandi-green: #8a9a7e;
  --morandi-warm: #c4b8a8;
  --morandi-sage: #9a9a8a;
  --morandi-lavender: #9a95a8;

  /* åŠŸèƒ½è‰² */
  --border-color: #d1ccc6;
  --border-light: #e0dcd6;
  --code-bg: #f5f2ed;
  --table-header: #ebe7e1;
  --shadow: rgba(139, 134, 128, 0.15);
  --shadow-strong: rgba(139, 134, 128, 0.25);

  /* åè‰²ï¼ˆç”¨äºæŒ‰é’®ã€æ ‡ç­¾ç­‰ï¼‰ */
  --inverse-bg: #4a4a4a;
  --inverse-text: #f7f5f0;

  /* å­—ä½“æ ˆ */
  --font-serif: "Noto Serif CJK SC", "Source Han Serif SC", "SimSun", "STSong", "Noto Serif", serif;
  --font-sans: "PingFang SC", "Microsoft YaHei", "Noto Sans CJK SC", "WenQuanYi Micro Hei", sans-serif;
  --font-mono: "JetBrains Mono", "Fira Code", "Sarasa Mono SC", "Noto Sans Mono CJK SC", monospace;
}

/* -------------------------------------------
   å¤œé—´æ¨¡å¼å˜é‡è¦†ç›–
   ------------------------------------------- */
@media (prefers-color-scheme: dark) {
  :root {
    /* åŸºç¡€èƒŒæ™¯ä¸æ–‡å­— - æ·±æš–ç°ç³» */
    --bg-primary: #2c2c2e;
    --bg-secondary: #323234;
    --bg-tertiary: #3a3a3c;
    --text-primary: #d4ccc4;
    --text-secondary: #b8b0a8;
    --text-muted: #9a948e;

    /* è«å…°è¿ªæš—è‰²ç‰ˆ - æé«˜äº®åº¦ä½†ä¿æŒä½é¥±å’Œåº¦ */
    --morandi-blue: #8a9eb0;
    --morandi-rose: #c4b0a8;
    --morandi-green: #9aaa8e;
    --morandi-warm: #b0a898;
    --morandi-sage: #a0a090;
    --morandi-lavender: #a8a0b8;

    /* åŠŸèƒ½è‰²æš—ç‰ˆ */
    --border-color: #4a4a4c;
    --border-light: #3a3a3c;
    --code-bg: #2a2a2c;
    --table-header: #363638;
    --shadow: rgba(0, 0, 0, 0.3);
    --shadow-strong: rgba(0, 0, 0, 0.5);

    /* åè‰²è°ƒæ•´ */
    --inverse-bg: #d4ccc4;
    --inverse-text: #2c2c2e;
  }

  /* å¤œé—´æ¨¡å¼å›¾ç‰‡ä¼˜åŒ– - é™ä½äº®åº¦é¿å…åˆºçœ¼ */
  img {
    opacity: 0.9;
    filter: brightness(0.9) contrast(1.1);
  }

  /* å¤œé—´æ¨¡å¼é€‰ä¸­æ–‡å­—é¢œè‰² */
  ::selection {
    background-color: rgba(138, 158, 176, 0.4);
    color: var(--text-primary);
  }
}

/* -------------------------------------------
   åŸºç¡€é‡ç½®ä¸å…¨å±€æ ·å¼
   ------------------------------------------- */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-sans);
  font-size: 16px;
  line-height: 1.8;
  color: var(--text-primary);
  background-color: var(--bg-primary);
  max-width: 850px;
  margin: 0 auto;
  padding: 3rem 2.5rem;
  letter-spacing: 0.02em;
  text-align: justify;
  word-wrap: break-word;
  hyphens: auto;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* é€‰ä¸­æ–‡æœ¬æ ·å¼ï¼ˆæ—¥é—´æ¨¡å¼ï¼‰ */
::selection {
  background-color: rgba(156, 168, 184, 0.3);
  color: var(--text-primary);
}

/* -------------------------------------------
   æ ‡é¢˜å±‚çº§
   ------------------------------------------- */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif);
  font-weight: 600;
  line-height: 1.4;
  margin-top: 2em;
  margin-bottom: 0.8em;
  color: var(--text-primary);
  letter-spacing: 0.05em;
  transition: color 0.3s ease;
}

h1 {
  font-size: 2.2em;
  text-align: center;
  margin-bottom: 1.5em;
  padding-bottom: 0.5em;
  border-bottom: 2px solid var(--morandi-warm);
}

h2 {
  font-size: 1.6em;
  margin-top: 2.5em;
  padding-left: 0.5em;
  border-left: 4px solid var(--morandi-blue);
}

h3 {
  font-size: 1.3em;
  margin-top: 2em;
  position: relative;
  padding-left: 1em;
}

h3::before {
  content: "â—†";
  position: absolute;
  left: 0;
  color: var(--morandi-rose);
  font-size: 0.6em;
  top: 0.3em;
}

h4 {
  font-size: 1.1em;
  color: var(--text-secondary);
  margin-top: 1.5em;
  font-weight: 500;
}
/* -------------------------------------------
   æ®µè½ä¸æ–‡æœ¬æµï¼ˆä¸­æ–‡æ’ç‰ˆä¼˜åŒ–ï¼‰
   ------------------------------------------- */
p {
  margin-bottom: 1.2em;
  text-indent: 2em;
}

/* å–æ¶ˆç‰¹å®šå…ƒç´ åçš„ç¼©è¿› */
h1 + p, h2 + p, h3 + p, h4 + p,
ul + p, ol + p,
blockquote + p,
pre + p,
table + p,
.figure + p {
  text-indent: 0;
}

strong, b {
  font-weight: 600;
  color: var(--text-primary);
  background: linear-gradient(transparent 60%, var(--morandi-rose) 60%);
  padding: 0 0.2em;
  /* ä¿®å¤ï¼šåˆ é™¤æ— æ•ˆçš„ background-opacityï¼Œæ”¹ç”¨ opacity æ§åˆ¶æ•´ä½“é€æ˜åº¦ */
  opacity: 0.95;
}

em, i {
  font-style: italic;
  color: var(--text-secondary);
  font-family: var(--font-serif);
}

mark {
  background-color: var(--morandi-rose);
  color: var(--bg-primary);
  padding: 0.1em 0.3em;
  border-radius: 2px;
  opacity: 0.9;
}

del {
  color: var(--text-muted);
  text-decoration: line-through;
  opacity: 0.7;
}

ins {
  text-decoration: none;
  border-bottom: 1px dashed var(--morandi-green);
  color: var(--text-primary);
}

/* -------------------------------------------
   å¤œé—´æ¨¡å¼åŠ ç²—æ–‡æœ¬ä¼˜åŒ–
   ------------------------------------------- */
@media (prefers-color-scheme: dark) {
  strong, b {
    /* ä½¿ç”¨æ›´äº®çš„æ–‡å­—é¢œè‰² */
    color: var(--inverse-bg);
    /* è°ƒæ•´èƒŒæ™¯é«˜äº®ï¼šä½¿ç”¨è«å…°è¿ªç«ç‘°è‰²ï¼Œä½†é™ä½é€æ˜åº¦å’Œè°ƒæ•´ä½ç½® */
    background: linear-gradient(transparent 40%, rgba(196, 176, 168, 0.4) 40%);
    /* æ·»åŠ æ–‡å­—é˜´å½±å¢å¼ºå¯è¯»æ€§ */
    text-shadow: 0 0 2px rgba(212, 204, 196, 0.2);
    opacity: 1;
  }

  mark {
    /* mark åœ¨å¤œé—´æ¨¡å¼ä¹Ÿéœ€è¦è°ƒæ•´ */
    background-color: var(--morandi-rose);
    color: var(--bg-primary);
    opacity: 1;
    font-weight: 600;
  }
}

/* -------------------------------------------
   é“¾æ¥æ ·å¼
   ------------------------------------------- */
a {
  color: var(--morandi-blue);
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.3s ease;
  padding: 0 0.1em;
}

a:hover {
  border-bottom-color: var(--morandi-blue);
  background-color: rgba(122, 143, 163, 0.1);
}

/* -------------------------------------------
   åˆ—è¡¨æ ·å¼
   ------------------------------------------- */
ul, ol {
  margin: 1.2em 0;
  padding-left: 2.5em;
}

li {
  margin-bottom: 0.6em;
  line-height: 1.7;
}

ul li {
  list-style-type: none;
  position: relative;
}

ul li::before {
  content: "â€¢";
  color: var(--morandi-sage);
  font-weight: bold;
  position: absolute;
  left: -1.2em;
  font-size: 1.2em;
  line-height: 1.4;
}

ul ul li::before {
  content: "â—¦";
  color: var(--morandi-warm);
}

ul ul ul li::before {
  content: "â–ª";
  color: var(--morandi-blue);
}

ol li {
  list-style-type: decimal;
  color: var(--text-primary);
}

ol ol li {
  list-style-type: lower-alpha;
}

dt {
  font-weight: 600;
  color: var(--text-primary);
  margin-top: 1em;
  font-family: var(--font-serif);
}

dd {
  margin-left: 2em;
  margin-bottom: 0.8em;
  color: var(--text-secondary);
  border-left: 2px solid var(--border-color);
  padding-left: 1em;
}
/* -------------------------------------------
   Mermaid æµç¨‹å›¾æ ·å¼ç¾åŒ–
   ------------------------------------------- */
.mermaid {
  display: block;
  margin: 2em auto;
  padding: 1.5em;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  box-shadow: 0 4px 12px var(--shadow);
  overflow-x: auto;
  text-align: center;
  transition: all 0.3s ease;
}

/* æµç¨‹å›¾å†…æ–‡å­— */
.mermaid text,
.mermaid tspan {
  font-family: var(--font-sans) !important;
  font-size: 14px !important;
  fill: var(--text-primary) !important;
}

/* èŠ‚ç‚¹æ ·å¼ */
.mermaid .node rect,
.mermaid .node circle,
.mermaid .node ellipse,
.mermaid .node polygon {
  fill: var(--bg-primary) !important;
  stroke: var(--morandi-blue) !important;
  stroke-width: 2px !important;
  filter: drop-shadow(0 2px 4px var(--shadow));
}

/* è¾¹çº¿ */
.mermaid .edgePath .path {
  stroke: var(--morandi-sage) !important;
  stroke-width: 1.5px !important;
  stroke-linecap: round;
}

/* ç®­å¤´ */
.mermaid .arrowheadPath {
  fill: var(--morandi-sage) !important;
}

/* å­å›¾æ ·å¼ */
.mermaid .cluster rect {
  fill: rgba(122, 143, 163, 0.08) !important;
  stroke: var(--morandi-warm) !important;
  stroke-dasharray: 5, 5;
  stroke-width: 1.5px;
}

/* æ ‡ç­¾èƒŒæ™¯ */
.mermaid .label {
  background-color: var(--bg-primary) !important;
  color: var(--text-primary) !important;
}

/* æ‚¬åœæ•ˆæœ */
.mermaid:hover {
  box-shadow: 0 6px 20px var(--shadow-strong);
  transform: translateY(-2px);
}

/* ä»£ç å—æ ‡ç­¾ */
pre.src-mermaid::before {
  content: "æµç¨‹å›¾";
  position: absolute;
  top: -12px;
  left: 1em;
  background: var(--morandi-blue);
  color: var(--bg-primary);
  padding: 0.2em 0.8em;
  border-radius: 12px;
  font-size: 0.75em;
  font-family: var(--font-sans);
  font-weight: 600;
  box-shadow: 0 2px 4px var(--shadow);
}

pre.src-mermaid {
  position: relative;
  padding-top: 2em;
  background-color: var(--code-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
}

@media (prefers-color-scheme: dark) {
  .mermaid {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
  }

  .mermaid .node rect,
  .mermaid .node circle {
    fill: var(--bg-tertiary) !important;
    stroke: var(--morandi-blue) !important;
  }

  .mermaid .edgePath .path {
    stroke: var(--morandi-warm) !important;
  }
}
/* -------------------------------------------
   å¼•ç”¨å—
   ------------------------------------------- */
blockquote {
  margin: 2em 1.5em;
  padding: 1em 1.5em;
  background-color: rgba(154, 154, 138, 0.15);
  border-left: 4px solid var(--morandi-sage);
  border-radius: 0 4px 4px 0;
  color: var(--text-secondary);
  font-family: var(--font-serif);
  font-style: italic;
  position: relative;
  transition: background-color 0.3s ease;
}

@media (prefers-color-scheme: dark) {
  blockquote {
    background-color: rgba(160, 160, 144, 0.1);
  }
}

blockquote::before {
  content: """;
  font-size: 3em;
  color: var(--morandi-sage);
  position: absolute;
  left: 0.2em;
  top: -0.2em;
  opacity: 0.3;
  font-family: Georgia, serif;
}

blockquote p {
  text-indent: 0;
  margin-bottom: 0.8em;
}

blockquote p:last-child {
  margin-bottom: 0;
}

blockquote cite {
  display: block;
  text-align: right;
  font-size: 0.9em;
  color: var(--text-muted);
  font-style: normal;
  margin-top: 0.5em;
}

blockquote cite::before {
  content: "â€”â€” ";
}

/* -------------------------------------------
   ä»£ç ä¸å…¬å¼
   ------------------------------------------- */
code, kbd, tt {
  font-family: var(--font-mono);
  font-size: 0.9em;
  background-color: var(--code-bg);
  color: var(--text-primary);
  padding: 0.2em 0.4em;
  border-radius: 3px;
  border: 1px solid var(--border-color);
  transition: all 0.3s ease;
}

pre {
  background-color: var(--code-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 1.2em;
  margin: 1.5em 0;
  overflow-x: auto;
  font-family: var(--font-mono);
  font-size: 0.9em;
  line-height: 1.6;
  box-shadow: inset 0 1px 3px var(--shadow);
  transition: all 0.3s ease;
}

pre code {
  background: none;
  border: none;
  padding: 0;
  font-size: 1em;
  color: var(--text-primary);
}

/* ä»£ç é«˜äº®é¢œè‰²é€‚é… */
.org-keyword { color: var(--morandi-blue); font-weight: 600; }
.org-string { color: var(--morandi-rose); }
.org-comment { color: var(--morandi-green); font-style: italic; }
.org-function { color: var(--morandi-sage); }
.org-number { color: var(--morandi-lavender); }
.org-type { color: var(--morandi-warm); }

/* -------------------------------------------
   è¡¨æ ¼ - ç»æµæ•°æ®ä¸“ç”¨
   ------------------------------------------- */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5em 0;
  font-size: 0.95em;
  background-color: transparent;
  box-shadow: 0 2px 8px var(--shadow);
}

thead {
  background-color: var(--table-header);
  border-bottom: 2px solid var(--border-color);
  transition: background-color 0.3s ease;
}

th {
  font-family: var(--font-serif);
  font-weight: 600;
  color: var(--text-primary);
  padding: 0.8em 1em;
  text-align: left;
  letter-spacing: 0.05em;
}

td {
  padding: 0.7em 1em;
  border-bottom: 1px solid var(--border-color);
  color: var(--text-primary);
  transition: border-color 0.3s ease;
}

tbody tr:nth-child(even) {
  background-color: rgba(196, 184, 168, 0.1);
}

tbody tr:hover {
  background-color: rgba(122, 143, 163, 0.1);
}

/* æ•°å€¼åˆ—å³å¯¹é½ */
td.numeric, td:nth-child(n+2) {
  text-align: right;
  font-family: var(--font-mono);
}

/* -------------------------------------------
   æ°´å¹³çº¿
   ------------------------------------------- */
hr {
  border: none;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--morandi-warm), transparent);
  margin: 3em 0;
  position: relative;
}

hr::after {
  content: "Â§";
  position: absolute;
  left: 50%;
  top: -0.7em;
  transform: translateX(-50%);
  background-color: var(--bg-primary);
  color: var(--morandi-warm);
  padding: 0 1em;
  font-size: 1.2em;
  transition: background-color 0.3s ease;
}

/* -------------------------------------------
   å›¾ç‰‡ä¸å›¾è¡¨
   ------------------------------------------- */
img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 2em auto;
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow);
  transition: all 0.3s ease;
}

.figure {
  text-align: center;
  margin: 2em 0;
}

.figure p {
  text-indent: 0;
  font-size: 0.9em;
  color: var(--text-muted);
  margin-top: 0.8em;
  font-style: italic;
}

/* -------------------------------------------
   è„šæ³¨
   ------------------------------------------- */
.footpara {
  font-size: 0.9em;
  color: var(--text-muted);
  margin: 0.5em 0;
  padding-left: 1.5em;
  text-indent: -1.5em;
}

.footref {
  color: var(--morandi-blue);
  font-size: 0.8em;
  vertical-align: super;
  text-decoration: none;
}
/* -------------------------------------------
   ç‰¹æ®ŠåŒºå— - æç¤ºä¸æ³¨æ„ï¼ˆå›¾æ ‡ç½®é¡¶ç‰ˆï¼‰
   ------------------------------------------- */
.tip, .note, .warning, .important, .remark,
.theory, .definition, .gap, .example, .question {
  margin: 2em 0 1.5em 0;  /* é¡¶éƒ¨å¢åŠ é—´è·ï¼Œä¸ºå›¾æ ‡ç•™å‡ºå‘¼å¸ç©ºé—´ */
  padding: 2.5em 1.5em 1.2em 1.5em;  /* é¡¶éƒ¨paddingå¢å¤§ï¼Œå·¦ä¾§å–æ¶ˆç‰¹æ®Špadding */
  border-radius: 6px;
  position: relative;
  transition: all 0.3s ease;
}

/* å›¾æ ‡ç»Ÿä¸€æ ·å¼ - ç½®é¡¶å±…ä¸­ */
.tip::before, .note::before, .warning::before, .important::before, .remark::before,
.theory::before, .definition::before, .gap::before, .example::before, .question::before {
  position: absolute;
  left: 50%;
  top: 0;  /* ç½®äºæœ€é¡¶éƒ¨ */
  transform: translate(-50%, -50%);  /* æ°´å¹³å‚ç›´å±…ä¸­ï¼Œå¹¶å‘ä¸Šåç§»ä¸€åŠä½¿å›¾æ ‡éª‘åœ¨è¾¹æ¡†ä¸Š */
  font-size: 1.5em;
  background-color: var(--bg-primary);  /* èƒŒæ™¯è‰²ä¸é¡µé¢ä¸€è‡´ï¼Œåˆ¶é€ "æµ®å‡º"æ•ˆæœ */
  padding: 0 0.5em;
  border-radius: 50%;  /* åœ†å½¢èƒŒæ™¯ */
  line-height: 1;
  z-index: 1;
}

/* å¤œé—´æ¨¡å¼ä¸‹çš„å›¾æ ‡èƒŒæ™¯é€‚é… */
@media (prefers-color-scheme: dark) {
  .tip::before, .note::before, .warning::before, .important::before, .remark::before,
  .theory::before, .definition::before, .gap::before, .example::before, .question::before {
    background-color: var(--bg-primary);
  }
}

/* åŸæœ‰é¢œè‰²å®šä¹‰ä¿æŒä¸å˜ */
.tip {
  background-color: rgba(138, 154, 126, 0.15);
  border-left: 4px solid var(--morandi-green);
  border-top: 1px solid rgba(138, 154, 126, 0.3);
}
.tip::before { content: "ğŸ’¡"; filter: grayscale(0.2); }

.note {
  background-color: rgba(122, 143, 163, 0.15);
  border-left: 4px solid var(--morandi-blue);
  border-top: 1px solid rgba(122, 143, 163, 0.3);
}
.note::before { content: "ğŸ“"; filter: grayscale(0.2); }

.warning {
  background-color: rgba(176, 168, 152, 0.2);
  border-left: 4px solid var(--morandi-warm);
  border-top: 1px solid rgba(176, 168, 152, 0.3);
}
.warning::before { content: "âš ï¸"; filter: grayscale(0.2); }

.important {
  background-color: rgba(196, 176, 168, 0.2);
  border-left: 4px solid var(--morandi-rose);
  border-top: 1px solid rgba(196, 176, 168, 0.3);
}
.important::before { content: "â—"; filter: grayscale(0.2); }

.remark {
  background-color: rgba(154, 149, 168, 0.15);
  border-left: 4px solid var(--morandi-lavender);
  border-top: 1px solid rgba(154, 149, 168, 0.3);
}
.remark::before { content: "ğŸ“Œ"; filter: grayscale(0.2); }

/* -------------------------------------------
   å­¦æœ¯ä¸“ç”¨åŒºå—æ‰©å±•ï¼ˆå›¾æ ‡ç½®é¡¶ï¼‰
   ------------------------------------------- */
.theory {
  background-color: rgba(122, 143, 163, 0.12);
  border-left: 4px solid var(--morandi-blue);
  border-top: 1px solid rgba(122, 143, 163, 0.25);
}
.theory::before { content: "ğŸ“–"; }

.definition {
  background-color: rgba(154, 154, 138, 0.12);
  border-left: 4px solid var(--morandi-sage);
  border-top: 1px solid rgba(154, 154, 138, 0.25);
}
.definition::before { content: "ğŸ“‹"; }

.gap {
  background-color: rgba(184, 168, 160, 0.2);
  border-left: 4px solid var(--morandi-rose);
  border-right: 2px dashed var(--morandi-rose);
  border-top: 1px solid rgba(184, 168, 160, 0.3);
}
.gap::before { content: "ğŸ”"; }

.example {
  background-color: rgba(196, 184, 168, 0.15);
  border-left: 4px solid var(--morandi-warm);
  border-top: 1px solid rgba(196, 184, 168, 0.3);
}
.example::before { content: "ğŸ’­"; }

.question {
  background-color: rgba(154, 149, 168, 0.15);
  border-left: 4px solid var(--morandi-lavender);
  border-top: 1px solid rgba(154, 149, 168, 0.3);
}
.question::before { content: "â“"; }

/* -------------------------------------------
   Org ç‰¹å®šå…ƒç´ 
   ------------------------------------------- */
.timestamp {
  font-family: var(--font-mono);
  font-size: 0.85em;
  color: var(--text-muted);
  background-color: var(--bg-secondary);
  padding: 0.1em 0.4em;
  border-radius: 3px;
  border: 1px solid var(--border-light);
}

.tag {
  font-size: 0.75em;
  background-color: var(--morandi-warm);
  color: var(--inverse-text);
  padding: 0.1em 0.6em;
  border-radius: 12px;
  margin-left: 0.5em;
  font-weight: 500;
  letter-spacing: 0.05em;
  opacity: 0.9;
}

.todo {
  font-family: var(--font-mono);
  font-size: 0.8em;
  font-weight: 600;
  padding: 0.1em 0.4em;
  border-radius: 3px;
  margin-right: 0.3em;
  display: inline-block;
}

.todo.TODO { background-color: var(--morandi-rose); color: var(--bg-primary); }
.todo.DONE { background-color: var(--morandi-green); color: var(--bg-primary); }
.todo.WAIT { background-color: var(--morandi-blue); color: var(--bg-primary); }

.priority {
  font-family: var(--font-mono);
  font-size: 0.8em;
  color: var(--morandi-rose);
  font-weight: bold;
}

/* -------------------------------------------
   æ•°å­¦å…¬å¼ (MathJax/KaTeX)
   ------------------------------------------- */
.mjx-chtml, .katex {
  font-size: 1em !important;
  color: var(--text-primary);
}

.math-inline {
  color: var(--text-primary);
}

.equation {
  margin: 1.5em 0;
  text-align: center;
  position: relative;
  overflow-x: auto;
}

.equation-number {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  font-size: 0.9em;
}

/* -------------------------------------------
   ç›®å½•æ ·å¼
   ------------------------------------------- */
#table-of-contents {
  background-color: rgba(196, 184, 168, 0.15);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 1.5em;
  margin: 2em 0;
  font-size: 0.95em;
  transition: all 0.3s ease;
}

#table-of-contents h2 {
  font-size: 1.2em;
  margin-top: 0;
  border-left: none;
  text-align: center;
  padding-left: 0;
  color: var(--text-primary);
}

#text-table-of-contents ul {
  list-style: none;
  padding-left: 0;
}

#text-table-of-contents li {
  margin: 0.4em 0;
}

#text-table-of-contents a {
  color: var(--text-primary);
  border-bottom: none;
  display: block;
  padding: 0.2em 0;
  transition: all 0.2s;
}

#text-table-of-contents a:hover {
  color: var(--morandi-blue);
  background-color: rgba(122, 143, 163, 0.1);
  padding-left: 0.5em;
  border-radius: 3px;
}

#text-table-of-contents ul ul {
  padding-left: 1.5em;
  font-size: 0.95em;
}

/* -------------------------------------------
   æ‰“å°ä¼˜åŒ–
   ------------------------------------------- */
@media print {
  body {
    background: white !important;
    color: black !important;
    font-size: 12pt;
    max-width: none;
    padding: 2cm;
  }

  a {
    color: #333 !important;
    text-decoration: none;
    border-bottom: 1px dotted #999;
  }

  h1, h2, h3 {
    page-break-after: avoid;
    color: black !important;
  }

  pre, blockquote, table {
    page-break-inside: avoid;
    background-color: #f5f5f5 !important;
  }

  .tip, .note, .warning, .important {
    background-color: #f5f5f5 !important;
    border: 1px solid #ddd;
  }
}

/* -------------------------------------------
   å“åº”å¼è®¾è®¡
   ------------------------------------------- */
@media (max-width: 768px) {
  body {
    padding: 1.5rem;
    font-size: 15px;
  }

  h1 { font-size: 1.8em; }
  h2 { font-size: 1.4em; }
  h3 { font-size: 1.2em; }

  pre {
    padding: 0.8em;
    font-size: 0.85em;
  }

  table {
    font-size: 0.9em;
  }

  td, th {
    padding: 0.5em;
  }

  blockquote {
    margin: 1.5em 0.5em;
  }
}

/* -------------------------------------------
   å¯æŠ˜å ç›®å½•æ ·å¼
   ------------------------------------------- */

/* ç›®å½•å†…å®¹åŒºåŸŸè¿‡æ¸¡åŠ¨ç”» */
#text-table-of-contents {
    overflow: hidden;
    max-height: 2000px; /* è¶³å¤Ÿå¤§çš„å€¼ä»¥å®¹çº³å†…å®¹ */
    opacity: 1;
    transform: translateY(0);
    transition: max-height 0.4s ease-out,
                opacity 0.3s ease-out,
                transform 0.3s ease-out,
                margin 0.3s ease;
}

/* æŠ˜å çŠ¶æ€ */
#text-table-of-contents.toc-collapsed {
    max-height: 0;
    opacity: 0;
    transform: translateY(-10px);
    margin-top: 0;
    margin-bottom: 0;
}

/* ç›®å½•æ ‡é¢˜äº¤äº’åé¦ˆ */
#table-of-contents h2 {
    position: relative;
    transition: color 0.2s ease, background-color 0.2s;
    padding: 0.5em 1em 0.5em 2em;
    margin-left: -1em;
    margin-right: -1em;
    border-radius: 6px;
}

#table-of-contents h2:hover {
    color: var(--morandi-blue);
    background-color: rgba(122, 143, 163, 0.1);
}

#table-of-contents h2:active {
    background-color: rgba(122, 143, 163, 0.2);
    transform: translateY(1px);
}

/* ç²˜æ€§ç›®å½•çš„æŠ˜å é€‚é…ï¼ˆå¤§å±å¹•ï¼‰ */
@media (min-width: 1200px) {
    #table-of-contents {
        transition: max-height 0.4s ease;
    }

    #text-table-of-contents.toc-collapsed {
        display: none; /* å›ºå®šå®šä½æ—¶ç›´æ¥éšè—æ›´æµç•… */
    }

    /* æŠ˜å æ—¶å‡å°ç›®å½•å®¹å™¨é«˜åº¦ */
    #table-of-contents:has(#text-table-of-contents.toc-collapsed) {
        max-height: 60px; /* ä»…æ˜¾ç¤ºæ ‡é¢˜ */
        overflow: hidden;
    }
}

/* æ‰“å°æ—¶å¼ºåˆ¶å±•å¼€ç›®å½•ï¼ˆä¸è¦æŠ˜å çŠ¶æ€ï¼‰ */
@media print {
    #text-table-of-contents {
        max-height: none !important;
        opacity: 1 !important;
        display: block !important;
    }

    #table-of-contents h2::before,
    #table-of-contents h2 span {
        display: none !important; /* éšè—ç®­å¤´ */
    }
}

/* ç›®å½•èŠ‚ç‚¹æŠ˜å åŠ¨ç”»ï¼ˆå¯é€‰ï¼šæ”¯æŒäºŒçº§ç›®å½•æŠ˜å ï¼‰ */
#text-table-of-contents ul ul {
    overflow: hidden;
    max-height: 1000px;
    transition: max-height 0.3s ease;
}

/* å“åº”å¼ä¼˜åŒ–ï¼šç§»åŠ¨ç«¯ç›®å½•é»˜è®¤æŠ˜å ï¼ˆå¯é€‰ï¼‰ */
@media (max-width: 768px) {
    #text-table-of-contents {
        max-height: 300px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }
}
