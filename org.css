/* Modern Org-mode Theme "Zen"
   Designed for Clarity, Focus, and Typography.
*/

/* =========================================
   1. Design Tokens (Variables)
   ========================================= */
:root {
    /* --- 基础尺寸与排版 --- */
    --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Helvetica, Arial, sans-serif;
    --font-mono: "JetBrains Mono", "Fira Code", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
    --line-height: 1.75;
    --max-width: 860px; /* 黄金阅读宽度 */
    --radius: 8px;

    /* --- 浅色模式 (Light) --- */
    --bg-body: #ffffff;
    --fg-text: #2c3e50;       /* 深灰蓝，比纯黑更护眼 */
    --fg-muted: #64748b;      /* 次级文字 */
    --fg-heading: #1a202c;    /* 标题色 */

    --color-primary: #0066cc; /* 链接、主色 */
    --color-accent: #3b82f6;

    --bg-code: #f8fafc;       /* 代码块浅灰背景 */
    --border-color: #e2e8f0;

    --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);

    /* 语义化颜色 (Admonitions) */
    --note-bg: #eff6ff; --note-border: #3b82f6; --note-fg: #1e40af;
    --tip-bg: #ecfdf5;  --tip-border: #10b981; --tip-fg: #065f46;
    --warn-bg: #fffbeb; --warn-border: #f59e0b; --warn-fg: #92400e;
    --fail-bg: #fef2f2; --fail-border: #ef4444; --fail-fg: #b91c1c;
}

/* --- 深色模式 (Dark) --- */
@media (prefers-color-scheme: dark) {
    :root {
        --bg-body: #0f1115;   /* 深邃黑，非纯黑 */
        --fg-text: #cbd5e1;   /* 柔和灰白 */
        --fg-muted: #94a3b8;
        --fg-heading: #f1f5f9;

        --color-primary: #60a5fa; /* 提亮链接色 */
        --color-accent: #3b82f6;

        --bg-code: #1e293b;
        --border-color: #334155;

        --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.5);

        /* 深色模式下的提示框调整 */
        --note-bg: rgba(59, 130, 246, 0.1); --note-border: #3b82f6; --note-fg: #93c5fd;
        --tip-bg: rgba(16, 185, 129, 0.1);  --tip-border: #10b981; --tip-fg: #6ee7b7;
        --warn-bg: rgba(245, 158, 11, 0.1); --warn-border: #f59e0b; --warn-fg: #fcd34d;
        --fail-bg: rgba(239, 68, 68, 0.1);  --fail-border: #ef4444; --fail-fg: #fca5a5;
    }
    /* 降低图片亮度，防止夜间刺眼 */
    img, video { opacity: 0.85; transition: opacity 0.3s ease; }
    img:hover, video:hover { opacity: 1; }
}

/* =========================================
   2. Reset & Layout
   ========================================= */
*, *::before, *::after { box-sizing: border-box; }

body {
    font-family: var(--font-sans);
    background-color: var(--bg-body);
    color: var(--fg-text);
    line-height: var(--line-height);
    font-size: 17px; /* 略大的字号提升阅读体验 */
    margin: 0;
    padding: 0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* 核心容器 */
#content, body > div {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 3rem 1.5rem 6rem; /* 上左右下的留白 */
}

/* 链接动画 */
a {
    color: var(--color-primary);
    text-decoration: none;
    background-image: linear-gradient(var(--color-primary), var(--color-primary));
    background-position: 0% 100%;
    background-repeat: no-repeat;
    background-size: 0% 2px;
    transition: background-size 0.3s;
}
a:hover {
    background-size: 100% 2px;
}
a img { border: none; }

/* =========================================
   3. Typography & Headings
   ========================================= */
h1, h2, h3, h4, h5, h6 {
    color: var(--fg-heading);
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2em;
    margin-bottom: 0.8em;
    letter-spacing: -0.02em;
}

h1 { font-size: 2.5em; margin-top: 0.5em; padding-bottom: 0.5em; border-bottom: 1px solid var(--border-color); }
h2 { font-size: 1.8em; }
h3 { font-size: 1.5em; }
h4 { font-size: 1.25em; }

/* 元数据 (作者、日期等) */
.title { text-align: center; margin-bottom: 0.5em; }
.subtitle { text-align: center; color: var(--fg-muted); font-size: 1.1em; font-weight: normal; margin-top: 0; }
.status, .org-document-info-keyword { color: var(--fg-muted); font-size: 0.9em; }

/* 目录 (Table of Contents) */
#table-of-contents {
    background: var(--bg-code);
    padding: 1.5rem;
    border-radius: var(--radius);
    margin: 2rem 0;
    border: 1px solid var(--border-color);
}
#table-of-contents h2 {
    margin-top: 0;
    font-size: 1.2em;
    border-bottom: none;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--fg-muted);
}
#table-of-contents ul { padding-left: 1.5em; margin-bottom: 0; }
#table-of-contents li { list-style: none; margin: 0.4em 0; }
#table-of-contents a {
    color: var(--fg-text);
    background-image: none; /* 目录不需要下划线动画 */
}
#table-of-contents a:hover { color: var(--color-primary); }

/* =========================================
   4. Code Blocks (Mac Window Style)
   ========================================= */
pre, code {
    font-family: var(--font-mono);
}

/* 行内代码 */
code {
    background-color: var(--bg-code);
    color: var(--color-accent); /* 强调色 */
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.85em;
    vertical-align: middle;
}

/* 代码块容器 */
.org-src-container {
    margin: 2rem 0;
    background: var(--bg-code);
    border: 1px solid var(--border-color);
    border-radius: var(--radius);
    overflow: hidden; /* 裁剪圆角 */
    position: relative;
    box-shadow: var(--shadow-card);
}

/* 模拟 Mac 窗口红黄绿点 */
.org-src-container::before {
    content: "";
    display: block;
    height: 12px;
    width: 12px;
    background-color: #ff5f56; /* Red */
    border-radius: 50%;
    position: absolute;
    top: 15px;
    left: 15px;
    box-shadow: 20px 0 0 #ffbd2e, 40px 0 0 #27c93f; /* Yellow & Green */
    z-index: 2;
}

/* 语言标签 (右上角) */
.org-src-container > pre::before {
    display: block;
    position: absolute;
    top: 10px;
    right: 15px;
    color: var(--fg-muted);
    font-size: 0.75rem;
    font-family: var(--font-sans);
    font-weight: 600;
    text-transform: uppercase;
    opacity: 0.6;
}

/* 代码块正文 */
.org-src-container > pre {
    margin: 0;
    padding: 3.5rem 1.2rem 1.2rem; /* 顶部留出空间给红黄绿点 */
    overflow-x: auto;
    font-size: 0.9em;
    line-height: 1.6;
    color: var(--fg-text); /* 默认文字颜色 */
    background: transparent;
    border: none;
}

/* 滚动条美化 */
.org-src-container > pre::-webkit-scrollbar { height: 8px; }
.org-src-container > pre::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }

/* 强制覆盖 Emacs 导出的某些可能看不清的语法高亮 (Dark Mode 修正) */
@media (prefers-color-scheme: dark) {
    .org-comment, .org-comment-delimiter { color: #6272a4 !important; font-style: italic; }
    .org-string { color: #f1fa8c !important; }
    .org-keyword { color: #ff79c6 !important; }
    .org-function-name { color: #8be9fd !important; }
    .org-variable-name { color: #f8f8f2 !important; }
    .org-type { color: #8be9fd !important; }
    .org-constant { color: #bd93f9 !important; }
}

/* =========================================
   5. Content Elements
   ========================================= */
/* 引用块 (Blockquote) */
blockquote {
    margin: 2rem 0;
    padding: 1rem 1.5rem;
    border-left: 4px solid var(--color-primary);
    background: var(--bg-code);
    color: var(--fg-text);
    font-style: italic;
    border-radius: 0 var(--radius) var(--radius) 0;
}

/* 表格 (Table) */
table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
    margin: 2rem 0;
    overflow-x: auto;
    display: block; /* 响应式 */
    border: 1px solid var(--border-color);
    border-radius: var(--radius);
}

th, td {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border-color);
    text-align: center;
    vertical-align: middle;  /* 垂直居中 */
}

th {
    background-color: var(--bg-code);
    font-weight: 600;
    color: var(--fg-heading);
    border-right: 1px solid var(--border-color);
}
th:last-child { border-right: none; }

td { border-right: 1px solid var(--border-color); }
td:last-child { border-right: none; }
tr:last-child td { border-bottom: none; }

/* 图片 */
figure { margin: 2rem 0; text-align: center; }
img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius);
    box-shadow: var(--shadow-card);
}
figcaption {
    margin-top: 0.8em;
    font-size: 0.9em;
    color: var(--fg-muted);
    font-style: italic;
}

/* 分割线 */
hr {
    border: 0;
    height: 1px;
    background: var(--border-color);
    margin: 3rem 0;
}

/* =========================================
   6. Custom Admonitions (Callouts)
   ========================================= */
.remark, .info, .idea, .warning, .tip {
    padding: 1rem 1.2rem;
    margin: 1.5rem 0;
    border-left: 4px solid;
    border-radius: 4px;
    font-size: 0.95em;
    display: flex;
    flex-direction: column;
}

/* 标题样式 */
.remark::before, .info::before, .idea::before, .warning::before, .tip::before {
    font-weight: 700;
    margin-bottom: 0.4em;
    text-transform: uppercase;
    font-size: 0.85em;
    letter-spacing: 0.05em;
}

/* 颜色配置 */
.remark { background: var(--warn-bg); border-color: var(--warn-border); color: var(--warn-fg); }
.remark::before { content: "Remark"; opacity: 0.8; }

.info, .idea { background: var(--note-bg); border-color: var(--note-border); color: var(--note-fg); }
.info::before { content: "Info"; opacity: 0.8; }
.idea::before { content: "Idea"; opacity: 0.8; }

.warning { background: var(--fail-bg); border-color: var(--fail-border); color: var(--fail-fg); }
.warning::before { content: "Warning"; opacity: 0.8; }

.tip { background: var(--tip-bg); border-color: var(--tip-border); color: var(--tip-fg); }
.tip::before { content: "Tip"; opacity: 0.8; }

/* 列表紧凑化 */
ul, ol { padding-left: 1.5em; }
li { margin-bottom: 0.4em; }
li p { margin: 0.2em 0; }

/* 待办列表 */
.org-ul .off { opacity: 0.6; }
.org-ul .on { color: var(--color-primary); font-weight: bold; }
